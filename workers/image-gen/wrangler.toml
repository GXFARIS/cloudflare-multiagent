# Image Generation Worker Configuration

name = "image-gen"
main = "index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Worker settings
workers_dev = true

# D1 Database (Team 1's Config Service database)
# [[d1_databases]]
# binding = "CONFIG_DB"
# database_name = "multi-agent-config"
# database_id = "your-database-id"

# KV Cache for instance config
# [[kv_namespaces]]
# binding = "KV_CACHE"
# id = "your-kv-namespace-id"

# R2 Storage for generated images
[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "production-images"

# Rate Limiter Durable Object
[[durable_objects.bindings]]
name = "RATE_LIMITER"
class_name = "RateLimiter"
script_name = "rate-limiter"

# Environment Variables
[vars]
DEFAULT_PROVIDER = "ideogram"
CDN_URL = "https://cdn.example.com"

# Secrets (set with: wrangler secret put <NAME>)
# - IDEOGRAM_API_KEY

# Custom routes
routes = [
  { pattern = "images.your-domain.com/*", zone_name = "your-domain.com" }
]
